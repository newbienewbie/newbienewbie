---
layout: post
title: OpenShift 宕机？
date: 2016-10-22 13:26:36
tags:
- OpenShift
- DDoS
- DNS
categories:
- Misc
---

凌晨00:20左右，突然发现本博客网站不能访问：

{% asset_img "博客网站故障.jpg" "openshift控制台无法打开" %}

这倒霉劲！这才部署几天啊！

然后开始排查原因之旅。

## 域名、DNS

由于图便宜、省事，网站放在墙外、域名也没备案，尽管用了百度云加速，在国内访问本网站仍然常有不稳定现象发生。
所以首先怀疑的是`DNS污染`,类似之前[写的这篇博文](http://www.itminus.com/2015/08/14/Misc/Github-and-DNS-Hijacking-by-Somebody/)。于是开VPN远程登陆另一地区的某台服务器，发现我部署在上面的监控程序也捕获到了博客异常。
于是搭梯子访问，依然如此。

## OpenShift 宕机了吗？

我开始意识到了事情绝非那么简单，于是想登陆`OpenShift`控制台，看看我的程序是不是挂了。然后发现：

{% asset_img "openshift控制台无法打开.jpg" "openshift控制台无法打开" %}

`OpenShift` 的 Web 控制台竟然也挂了。


恰在此时，收到了百度短信推送：

> [百度]你好，你的网站http://www.itminus.com 发现运行故障！发现时间：2016-10-22 00:54:00。请及时登录百度云观测处理，以免引起损失<百度云观测> 

一不小心点到网站的连接，竟然正常了？拿电脑再次访问，竟然也正常。

不过我好奇的是百度云加速提示我的`1001`错误到底是什么，在[百度云加速FAQ](http://anquan.baidu.com/bbs/forum.php?mod=viewthread&tid=371363&page=1#pid1989640)查到：

{% asset_img "百度云-FAQ-1001.jpg" "百度云-FAQ-1001" %}

非常奇怪！百度云糊涂了吗？因为在这几日网站都是正常的，最近又没改动过什么，域名映射为啥不对？不管了，反正网站正常了。

谁知道，一眨眼功夫，再一访问又是提示这个错误！于是我连忙试了下部署在`OpenShift`的其他几个网站，发现竟然也都无法访问。
到这里我心里反倒安定了下来：应该不是我网站本身的问题了。

## DDoS

既然已经确认不是我网站本身问题，那就静待处理结果吧！

夜里又收到了两条百度推送：

> [百度]运行故障恢复（部分地区）：你好，你的网站http://www.itminus.com 发生的运行故障已在部分地区恢复！恢复时间：2016-10-22 04:44:00。查看更多详情，请登录<百度云观测>

> [百度]运行故障恢复（全部地区）：你好，你的网站http://www.itminus.com 已从运行故障中恢复！恢复时间：2016-10-22 06:34:00。查看更多详情，请登录<百度云观测>

第二天一早，还是觉得很蹊跷，`OpenShift` 官网也没放出消息。记得前几日黑客余弦微博上发了一个重磅消息说最近 Mirai DDoS 攻击源码被放出来，难道是机器人大军捣得鬼？
用关键词 openshift hack attack ddos 组合着搜了下，发现最近几日很多网站都遭到了 `DDoS`攻击 ,但是目前没发现有关`OpenShift`的新闻。

看来要成无头冤案了?

## 案件回头看

下午一上知乎，就看到了[相关讨论](https://www.zhihu.com/question/51848100)。 这感情好……`GitHub`、`Twitter`、`Visa`、`Heroku`数不清的各大网站都受到了影响！ 
大神王音也怀疑是[Mirai源代码的公开有关](https://www.zhihu.com/question/51848100)

回头看：当时看百度云加速提示的1001错误，觉得很奇怪，近期并为改动，为什么会报这个错误？
现在在才明白：原来这场 `DDoS` 攻击了诸多目标，其中就包括美国最主要的DNS服务商，直接效果就是导致我在`OpenShift`上的二级域名解析失败，所以百度云报"无法访问源站服务器"。


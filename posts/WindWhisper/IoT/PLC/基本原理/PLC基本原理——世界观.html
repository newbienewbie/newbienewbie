<!DOCTYPE html><html>
  <head>
    <meta charSet="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>
      Sample Fornax blog
    </title>
    <base href="/newbienewbie/"/>
    <script>
      document.addEventListener('DOMContentLoaded', () => {

	// Get all "navbar-burger" elements
	const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
  
	// Check if there are any navbar burgers
	if ($navbarBurgers.length > 0) {
  
	  // Add a click event on each of them
	  $navbarBurgers.forEach( el => {
		el.addEventListener('click', () => {
  
		  // Get the target from the "data-target" attribute
		  const target = el.dataset.target;
		  const $target = document.getElementById(target);
  
		  // Toggle the "is-active" class on both the "navbar-burger" and the "navbar-menu"
		  el.classList.toggle('is-active');
		  $target.classList.toggle('is-active');
  
		});
	  });
	}
  });
    </script>
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon.png"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans"/>
    <link rel="stylesheet" href="https://unpkg.com/bulma@0.8.0/css/bulma.min.css"/>
    <link rel="stylesheet" type="text/css" href="style/style.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/atom-one-dark-reasonable.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="container">
        <div class="navbar-brand">
          <a class="navbar-item" href="">
            <img src="images/bulma.png" alt="Logo"/>
          </a>
          <span class="navbar-burger burger" data-target="navbarMenu">
            <span></span>
            <span></span>
            <span></span>
          </span>
        </div>
        <div id="navbarMenu" class="navbar-menu">
          <a class="navbar-item" href="">
            Home
          </a>
          <a class="navbar-item" href="tags.html">
            Tags
          </a>
          <a class="navbar-item" href="about.html">
            About
          </a>
          <a class="navbar-item" href="contact.html">
            Contact
          </a>
        </div>
      </div>
    </nav>
    <section class="hero is-info is-medium is-bold">
      <div class="hero-body">
        <div class="container has-text-centered">
          <h1 class="title">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit
          </h1>
        </div>
      </div>
    </section>
    <div class="container">
      <section class="articles">
        <div class="column is-8 is-offset-2">
          <div class="card article">
            <div class="card-content">
              <div class="media-content has-text-centered">
                <p class="title article-title">
                  <a href="posts/WindWhisper/IoT/PLC/基本原理/PLC基本原理——世界观.html">
                    PLC基本原理——世界观
                  </a>
                </p>
                <nav class="breadcrumb">
                  <ul>
                    <li>
                      <a href="">
                        风语
                      </a>
                    </li>
                    <li>
                      <a href="">
                        IoT
                      </a>
                    </li>
                    <li>
                      <a href="">
                        PLC
                      </a>
                    </li>
                  </ul>
                </nav>
                <p class="post-tags">
                  <a href="tags.html#IoT">
                    <span class="tag is-info">
                      IoT
                    </span>
                  </a>
                  <a href="tags.html#PLC">
                    <span class="tag is-info">
                      PLC
                    </span>
                  </a>
                </p>
                <p class="subtitle is-6 article-subtitle">
                  <a href="#">
                    
                  </a>
                  on 2018-01-16
                </p>
              </div>
              <div class="content article-body">
                <p>可编程控制器(<code>Programmable Logic Controller</code>,<code>PLC</code>) 是一种专门为工业环境下应用而设计的数字运算操作的电子装置，<code>PLC</code>是在电器控制技术和计算机技术的基础上发展起来的。在<code>PLC</code>之前，大规模应用的是继电器，但是继电器体积大、接线复杂、可复用性差、速度慢、不易更改、适应性差，为了克服这些缺点，在1969年美国数字公司研制出了世界第一台PLC，开创了工业控制领域的新纪元。相比于继电器控制，<code>PLC</code>具有以下优点：</p>
<ul>
<li>高可靠性</li>
<li>I/O接口模块多</li>
<li>模块化结构</li>
<li>编程简单</li>
<li>安装简单、维修方便</li>
</ul>
<h2>基本结构</h2>
<p><code>PLC</code>最基本的结构主要有： <!--more--></p>
<ul>
<li><code>CPU</code></li>
<li>存储器：
<ul>
<li><code>RAM</code></li>
<li><code>ROM</code></li>
</ul>
</li>
<li><code>I/O</code>模块
<ul>
<li>输出接口: 包括<code>DO</code>、<code>AO</code>两种，常见的<code>DO</code>包括以下三种：
<ul>
<li>继电器输出型：触点输出，机械寿命长，动作慢</li>
<li>晶体管输出型: 主要用于高频小功率负载回路</li>
<li>晶闸管输出型: 耐压高，负载能力强，可用于大功率交流回路</li>
</ul>
</li>
<li>输入接口：通过<code>PLC</code>的输入端子接收现场输入设备的控制信号，包括<code>DI</code>、<code>AI</code>两种。输入信号通过光耦合器传送给内部电路，二者之间并无电的联系，这种隔断措施可以避免现场干扰。外部输入多为220V AC 或者 24V AC，内部工作电压多为5V。</li>
<li>I/O扩展接口: 用于扩展I/O点数。</li>
</ul>
</li>
<li>电源模块</li>
<li>机架/底板</li>
</ul>
<h2>基本工作原理</h2>
<p>概括来说，<code>PLC</code>是以不断循环的顺序扫描方式工作的，每次扫描所用时间称之为工作周期。<code>CPU</code>将从第一条指令开始，按顺序逐条执行用户程序，直到程序结束，然后开始新一轮扫描，周而复始。这种方式称之为“巡回扫描”。</p>
<ol>
<li>上电处理（电源ON --&gt;  内部处理）</li>
<li>扫描过程
<ul>
<li>2.1 输入处理（输入传送、远程I/O）</li>
<li>2.2 通信服务（外设、CPU、总线服务）</li>
<li>2.3 更新时钟、特殊寄存器</li>
<li>2.4 若CPU运行方式为<code>RUN</code>，则运行程序、然后进行输出处理；若<code>CPU</code>为<code>STOP</code>，则直接跳到下一步</li>
<li>2.5 执行自诊断，若PLC正常，则开始下一轮扫描过程；否则进入出错处理环节</li>
</ul>
</li>
<li>出错处理
<ul>
<li>存放自诊断结果</li>
<li>若非致命错误，进入下一轮扫描过程；若为致命错误，将CPU转为<code>STOP</code>状态，再进入下一轮扫描过程</li>
</ul>
</li>
</ol>
<p><code>PLC</code>的扫描过程主要分为三步：</p>
<ol>
<li>输入扫描：读入<code>PLC</code>上所有输入端子的输入信号，存入输入映像寄存器。</li>
<li>执行扫描：从上到下顺序执行指令，从输入状态映像寄存器读入数据，做逻辑运算/算术运算，将结果写入输出映像区。</li>
<li>输出扫描：将<code>PLC</code>输出状态映象寄存器的内容同时送入输出锁存器（称之为输出刷新），然后有锁存器经过功率放大后，把信号输出到输出端子。</li>
</ol>
<h2>PLC编程</h2>
<p>可见，<code>PLC</code>的工作可以类比于一个函数，接受一定输入，通过相应的计算，得到特定的输出。涉及到的存储器主要包括:</p>
<ul>
<li>外部输入（为了方便，后文用尽量采用记号<code>X</code>表示）</li>
<li>外部输出（为了方便，后文尽量采用记号<code>Y</code>表示）</li>
<li>内部寄存器（为了方便，后文尽量采用记号<code>R</code>表示）</li>
<li>定时器（为了方便，后文尽量采用记号<code>T</code>表示）</li>
<li>计数器（为了方便，后文尽量采用记号<code>C</code>表示）</li>
</ul>
<h3>梯形图与助记符语言</h3>
<p>梯形图是通过连线表示把<code>PLC</code>指令的梯形图符号连到一起的连通图，由于沿用了传统继电器接触控制的术语和符号，故使得其称为最广泛使用的<code>PLC</code>编程语言。助记符语言则与汇编语言非常类似，采用文字符号表达各种指令，由于各厂商提供的方言各不相同，所以助记符语言的移植性并不好。但是助记符语言便于书写、指令清晰，对于熟悉编程的人非常容易理解。例如，我们假设有如下记号(<code>token</code>)来表达相关指令:</p>
<ul>
<li><code>ST</code> : 表示<code>START</code></li>
<li><code>ED</code> : 表示<code>END</code></li>
<li><code>AN</code> : 表示逻辑<code>AND</code></li>
<li><code>OR</code> : 表示逻辑<code>OR</code></li>
<li><code>/</code>  : 表示逻辑<code>NOT</code></li>
<li><code>OT</code> :<code>OUTPUT</code>，指的是把当前运算结果输出到指定点</li>
</ul>
<p>举一个简单例子，假设有输入端子<code>X0</code>，目标输出为<code>Y0</code>、<code>Y1</code>，现有如下代码：</p>
<pre><code class="language-asm">ST   X 0
OT   Y 0
ST/  X 0
OT   Y 1
ED         
</code></pre>
<p>从指令上理解，可以想象有个栈式机器，先读入<code>X0</code>，然后将机器当前状态值输出到<code>Y0</code>；再将读入<code>X0</code>后取反作为机器当前状态，再将机器当前状态值输出到<code>Y1</code>。从功能上讲，这段代码表示当继电器<code>X0</code>闭合时，接通<code>Y0</code>；当<code>X0</code>断开时，接通<code>Y1</code>。</p>
<p>助记符语言可以等价转换为梯形图语言。</p>
<h3>应用举例</h3>
<pre><code class="language-asm">ST    X 0
OT    Y 0
/ 
OT    Y 1
</code></pre>
<p>表示</p>
<ul>
<li>当<code>XO</code>闭合，<code>Y0</code>接通，<code>Y1</code>断开</li>
<li>当<code>X0</code>断开，<code>Y0</code>断开，<code>Y1</code>接通</li>
</ul>
<p>再看一个比这个稍稍复杂一点点的例子，首先引入跟栈相关的三个指令：</p>
<ul>
<li><code>PSHS</code> : 把当前值压入栈中</li>
<li><code>POPS</code> : 弹出栈首</li>
<li><code>RDS</code>  : 读取栈首</li>
</ul>
<p>考虑有下面一段程序（为了更清晰的表达意图，我对程序做了缩进处理）:</p>
<pre><code class="language-asm">ST X 0
    PSHS 
        AN X 1
        OT Y 1
    RDS
        AN X 2
        OT Y 2
    POPS
        AN X 3
        OT Y 3
</code></pre>
<p>表示把<code>X0</code>依次和<code>X1</code>、<code>X2</code>、<code>X3</code>分别做与运算，相应的三个输出分别为<code>Y1</code>、<code>Y2</code>、<code>Y3</code>。从功能上讲，可以把<code>X0</code>想象成是总开关，而<code>X1</code>、<code>X2</code>、<code>X3</code>分别是用于控制<code>Y1</code>、<code>Y2</code>、<code>Y3</code>的三个开关。</p>

              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.1/katex.min.css" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.1/katex.min.js"></script>
    <script>
       // 处理形如 <code>$E=mc^2$</code> 形式的公式
 var inlineMathNodes=document.querySelectorAll('code');
 var re=/^\$(.*)\$$/;
 for(var j=0;j<inlineMathNodes.length;j++){
   var result=re.exec(inlineMathNodes.item(j).innerText);
   if(result!==null){
	 katex.render(result[1], inlineMathNodes.item(j));
   }
 }
 function removeNode(node){
   if(node.remove){
	 node.remove();
   }else{
	 return first.parentNode.removeChild(node);
   }
 };

 // 查找所有 pre code.language-math 节点 以备筛出数据公式
 var nodes=document.querySelectorAll("pre code.language-math");
 for(var i=0;i<nodes.length;i++){
   var node=nodes.item(i);
   // 魔术标记所在行 
   try{
	 var lines = node.innerText.split('\n');
	 if((!!lines) && lines.length > 0)
	 {
	   var first = lines[0];
	   if(first.trim().match(/%%(\s?)*KaTeX(\s?)*/i)){
		 var views = "";
		 // 逐行渲染
		 for(var k=1; k <lines.length; k++){
			 var f=lines[k];
			 views += katex.renderToString(f);
		 }
		 // 消除父级嵌套 
		 try{
		   node.innerHTML=views;
		 }catch(e){
		   // IE9 don't support the method of assignning value to tr.innerHTML. Maybe the code below will be removed in the future
		   console.log('IE9 sucks',e);
		   $(tr).html(node.innerHTML);
		 }
	   }
	 }
   }
   catch(err){
	 console.log(err)
   }
 }
    </script>
    <script>
      hljs.highlightAll();
    </script>
  </body>
</html>